---
style: |
  img {
    display: block;
    float: none;
    margin-left: auto;
    margin-right: auto;
  }
marp: true
paginate: true
---
### ë‹¨ê³„1: í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± 
```shell
vim ./src/data/pig_data.csv
# ì•„ëž˜ ë‚´ìš© ìž…ë ¥ 
10,1
10,3
10,6

cat ./src/data/pig_data.csv
```
---
![Alt text](./img/image-6.png)

---
### ë‹¨ê³„2: í•˜ë‘¡ì— ë°ì´í„° ì¶”ê°€
```shell
hdfs dfs -mkdir -p /pig/test/input
# hadoop ë°ì´í„° ì „ë‹¬
hdfs dfs -put /home/ubuntu/src/data/pig_data.csv /pig/test/input
# hadoop ë°ì´í„° í™•ì¸ 
hdfs dfs -ls -R /pig
```
---
![Alt text](./img/image-7.png)

---
### ë‹¨ê³„3: pig ë°ì´í„° í™•ì¸ 
```shell
# pig ì ‘ì† 
pig 

# pig > ë°ì´í„° í™•ì¸ 
cat /pig/test/input/pig_data.csv
```
---
![Alt text](./img/image-8.png)

---
### ë‹¨ê³„4: ë°ì´í„°ì˜ ì†ì„± ì´ë¦„ê³¼ ë°ì´í„° í˜•íƒœë¥¼ ì •í•˜ê³ , ì¶œë ¥
```shell
# ë°ì´í„° ì •ì˜
A = LOAD '/pig/test/input/pig_data.csv' USING PigStorage(',') AS (f1:int, f2:int);
# ë°ì´í„° ì¶œë ¥ 
DUMP A;
```
---
![Alt text](./img/image-9.png)

---
### ë‹¨ê³„5: A ë¦´ë ˆì´ì…˜ì˜ f1 , f2 ì†ì„±ê³¼ f1ê³¼ f2ë¥¼ ë‚˜ëˆ„ê¸° ì—°ì‚°í•˜ê³ , ë‚˜ë¨¸ì§€ë¥¼ ì„¸ë²ˆì§¸ ì†ì„±ìœ¼ë¡œ ì§€ì •í•˜ì—¬ X ë¦´ë ˆì´ì…˜ì— ì €ìž¥ í›„ ì¶œë ¥
- ëª…ë ¹ì–´ 
```shell
X = FOREACH A GENERATE f1, f2, f1%f2;
DUMP X;
```
- ê²°ê³¼
> (10, 1, 0) ðŸ¡ª 10 / 1ì˜ ëª«: 10, ë‚˜ë¨¸ì§€0
> (10, 3, 1) ðŸ¡ª 10 / 3ì˜ ëª«: 3, ë‚˜ë¨¸ì§€ 1
> (10, 6, 4) ðŸ¡ª 10 / 6ì˜ ëª«: 1, ë‚˜ë¨¸ì§€ 4
---
![Alt text](./img/image-10.png)

---
### ë‹¨ê³„6: (ë”í•˜ê¸° +), (ë¹¼ê¸° -), (ê³±í•˜ê¸° *), (ë‚˜ëˆ„ê¸° /)
- ëª…ë ¹ì–´ 
```shell
X = FOREACH A GENERATE f1, f2, f1+f2, f1-f2, f1*f2, f1/f2;
DUMP X;
```
- ê²°ê³¼
> (10, 1, 11, 9, 10, 10)
> - 10 + 1 = 1
> - 10 - 1 = 9
> - 10 * 1 = 10
> - 10 / 1 = 10
---
![Alt text](./img/image-11.png)
